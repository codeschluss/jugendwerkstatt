"use strict";(self.webpackChunkjugendwerkstatt=self.webpackChunkjugendwerkstatt||[]).push([[385],{40385:function(e,i,n){n.r(i);var t=n(93433),l=n(1413),a=n(37762),o=n(15861),d=n(29439),s=n(87757),r=n.n(s),u=n(35820),c=n(72791),v=n(61134),m=n(16871),f=n(14720),p=n(1841),g=n(34204),x=n(7043),b=n(77260),h=n(99374),j=n(80822),Z=n(80184);i.default=function(){var e,i=(0,m.UO)().id,n=(0,m.s0)(),s=(0,c.useState)(null),y=(0,d.Z)(s,2),k=y[0],T=y[1],N=(0,c.useState)(null),w=(0,d.Z)(N,2),U=w[0],I=w[1],S=(0,p.J8Z)({skip:!i,variables:{entity:{id:i}}}).data,C=(S=void 0===S?{}:S).page,z=void 0===C?null:C,L=(0,v.cI)({resolver:(0,u.L)(j.Iu),mode:"onChange",defaultValues:{images:[{file:null}],video:{file:null}}}),R=(0,p.dE5)({onCompleted:function(){return n("/admin/general-settings/public-pages")}}),V=(0,d.Z)(R,2),J=V[0],Q=V[1].loading,A=L.watch,G=L.reset,O=L.resetField,E=L.control,q=L.register,B=L.handleSubmit,D=L.formState.errors;console.log(z);var F=(0,v.Dq)({name:"images",control:E}),H=F.fields,P=F.append,K=F.remove,M=F.update,W=function(){var e=(0,o.Z)(r().mark((function e(n){var t,o,d,s,u,c,v,m,f,p,g,x,b,j,Z;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=[],c=(0,a.Z)(H),e.prev=2,c.s();case 4:if((v=c.n()).done){e.next=13;break}if(!(m=v.value).file){e.next=11;break}return e.next=9,(0,h.GJ)(m.file);case 9:f=e.sent,u.push((0,l.Z)({},f));case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),c.e(e.t0);case 18:return e.prev=18,c.f(),e.finish(18);case 21:if(p=n.video,g=null,z){e.next=43;break}x=(0,a.Z)(p),e.prev=25,x.s();case 27:if((b=x.n()).done){e.next=35;break}return j=b.value,e.next=31,(0,h.GJ)(j);case 31:Z=e.sent,g={name:Z.name,mimeType:Z.mimeType,base64:Z.base64};case 33:e.next=27;break;case 35:e.next=40;break;case 37:e.prev=37,e.t1=e.catch(25),x.e(e.t1);case 40:return e.prev=40,x.f(),e.finish(40);case 43:if(console.log("videos",p[0]),e.t2=J,e.t3=l.Z,e.t4=l.Z,e.t5=(0,l.Z)({},i&&{id:i}),e.t6={},e.t7={slug:n.pageName,name:n.pageName,content:n.description,images:u},e.t8=!(null===U||void 0===U||!U.file)&&0!==(null===U||void 0===U||null===(t=U.file)||void 0===t?void 0:t.size),!e.t8){e.next=56;break}return e.next=54,(0,h.GJ)(U.file);case 54:e.t9=e.sent,e.t8={titleImage:e.t9};case 56:e.t10=e.t8,e.t11=(0,e.t4)(e.t5,e.t6,e.t7,e.t10),e.t12={},e.t13={video:z?{id:null===(o=z.video)||void 0===o?void 0:o.id,mimeType:null===(d=z.video)||void 0===d?void 0:d.mimeType,base64:null===(s=z.video)||void 0===s?void 0:s.base64}:(0,l.Z)({},g)},e.t14=(0,e.t3)(e.t11,e.t12,e.t13),e.t15={entity:e.t14},e.t16={variables:e.t15},(0,e.t2)(e.t16);case 64:case"end":return e.stop()}}),e,null,[[2,15,18,21],[25,37,40,43]])})));return function(i){return e.apply(this,arguments)}}(),X=function(e,i){M(e,{file:i}),P({file:null})},Y=function(e){return function(){T(e)}};return(0,c.useEffect)((function(){if(z){var e,i,n,l,a,o,d,s,r=(null===z||void 0===z||null===(e=z.images)||void 0===e?void 0:e.map((function(e){return{file:(0,h.vy)((null===e||void 0===e?void 0:e.base64)||"",(null===e||void 0===e?void 0:e.mimeType)||"",(null===e||void 0===e?void 0:e.name)||"")}})))||[];G({pageName:z.name||"",description:z.content||"",images:[].concat((0,t.Z)(r),[{file:null}]),video:{file:(0,h.vy)((null===z||void 0===z||null===(i=z.video)||void 0===i?void 0:i.base64)||"",(null===z||void 0===z||null===(n=z.video)||void 0===n?void 0:n.mimeType)||"",(null===z||void 0===z||null===(l=z.video)||void 0===l?void 0:l.name)||"")}}),I({id:(null===z||void 0===z||null===(a=z.titleImage)||void 0===a?void 0:a.id)||"",file:(0,h.vy)((null===z||void 0===z||null===(o=z.titleImage)||void 0===o?void 0:o.base64)||"",(null===z||void 0===z||null===(d=z.titleImage)||void 0===d?void 0:d.mimeType)||"",(null===z||void 0===z||null===(s=z.titleImage)||void 0===s?void 0:s.name)||"")})}}),[z,G]),console.log(D,A()),(0,Z.jsx)(v.RV,(0,l.Z)((0,l.Z)({},L),{},{children:(0,Z.jsxs)("form",{children:[(0,Z.jsx)(x.UQ,{title:"Stammdaten",open:!!i,className:(0,h.Tn)(D.pageName&&"border border-primary"),children:(0,Z.jsx)(x.UP,(0,l.Z)((0,l.Z)({id:"pageName",label:"Stammdaten"},q("pageName")),{},{error:null===(e=D.pageName)||void 0===e?void 0:e.message}))}),(0,Z.jsx)(x.UQ,{title:"Titelbild",showSide:!0,sideClassName:"w-auto",sideContent:k&&(0,Z.jsx)(x.T2,(0,l.Z)((0,l.Z)({id:k.id},(null===k||void 0===k?void 0:k.file)&&{src:0===k.file.size?"".concat(f.T5,"media/").concat(null===k||void 0===k?void 0:k.id):URL.createObjectURL(k.file)}),{},{file:k.file,onHandle:function(e){I(e)},isTitleBild:(null===U||void 0===U?void 0:U.id)===k.id,onRemoveImage:function(e){K(H.findIndex((function(i){return i.id===e}))),T(null)}})),className:(0,h.Tn)(D.images&&"border border-primary"),children:(0,Z.jsx)("div",{className:"flex items-start justify-start",children:H.map((function(e,i){var n,t,a;return(0,Z.jsx)(x.VA,(0,l.Z)((0,l.Z)({preview:!0,index:i,id:"images.".concat(i,".file"),handleAppend:X,handleShow:Y(e)},q("images.".concat(i,".file"))),{},{error:null===(n=D.images)||void 0===n||null===(t=n[i])||void 0===t||null===(a=t.file)||void 0===a?void 0:a.message},!!e.file&&{src:0!==e.file.size?URL.createObjectURL(e.file):"".concat(f.T5,"media/").concat(null===e||void 0===e?void 0:e.id)}),i)}))})}),(0,Z.jsx)(x.UQ,{title:"Textfeld",className:(0,h.Tn)(D.description&&"border border-primary"),children:(0,Z.jsx)(b.kz,{})}),(0,Z.jsxs)(x.UQ,{title:"Video",className:(0,h.Tn)("p-5",D.video&&"border border-primary"),children:[(0,Z.jsx)("div",{className:"flex items-start justify-start",children:(0,Z.jsx)(x.VA,(0,l.Z)({id:"video",placeholderTitle:"Video hinzuf\xfcgen"},q("video")))}),(0,Z.jsx)("div",{className:"flex gap-x-2",children:(0,Z.jsx)(g.zx,{onClick:function(){return O("video")},className:"border-[#424242] text-[#424242]",type:"button",children:"L\xf6schen"})})]}),(0,Z.jsx)(x.iN,{loading:Q,onSubmit:B(W)})]})}))}}}]);
//# sourceMappingURL=385.dd0314cd.chunk.js.map